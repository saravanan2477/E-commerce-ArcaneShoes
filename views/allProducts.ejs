
<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width-device-width, initial-scale=1.0">
        <title>All Products - Redstore</title>
        <link rel="stylesheet" href="style.css">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
        <!--added a cdn link by searching font awesome4 cdn and getting this link from https://www.bootstrapcdn.com/fontawesome/ this url*/-->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<style>

    /* Pagination CSS */
.pagination {
  margin-top: 25px;
  text-align: center;
  margin-bottom: 25px;
}

.pagination a {
  color: #000;
  padding: 1px 17px;
  text-decoration: none;
  transition: background-color 0.3s;
}

.pagination a.active {
  background-color: #ff523b;
  color: white;
}

.pagination a:hover:not(.active) {
  background-color: #ddd;
}

.product-container {
    margin-bottom: 20px; /* Add margin-bottom to create space between products */
    margin-right: 20px; /* Add margin-right to create space between products */
    padding: 20px; /* Add padding to create space within the product container */
    box-sizing: border-box; /* Include padding and border in the element's total width and height */
}
.wishlist-container {
    margin-bottom: 30px;
}

.wishlist-icon {
    color: #888;
}

.wishlist-icon:hover {
    color: #f00;
}

.col-6 {
    width: 93%;
    float: left;
}

.clearfix::after {
    content: "";
    clear: both;
    display: table;
}

/* /wishlist */
.heart-button {
    font-size: 1.5em; /* Adjust the size as needed */
    display: inline-block;
    text-decoration: none;
    border-color: black;
    color: rgb(83, 78, 78); /* Change the color as needed */
    margin-right: 20px; /* Adjust the margin to move it to the right */
}

.heart-button:hover {
    color: rgb(211, 41, 41); /* Change the color as needed */
}

.col-6 img {
    width: 250px; /* Set the width to 575px */
    height: 250px; /* Set the height to 575px */
    object-fit: scale-down; /* Maintain aspect ratio and cover the container */
}

#product-container{
    max-width: 1270px;
    margin: auto;
    padding-left: 30px;
    padding-right: 0px;
}

#product-item{
    margin-bottom: 10px;
    margin-right: -25px;
    padding: 0px;
    box-sizing: border-box;
}

/* Sorting options CSS */
.sort-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 70px; /* Add some margin at the bottom */
            padding: 0px 41px; /* Add padding to create space */
            border-bottom: 0px solid #ddd; /* Add a bottom border for separation */
        }

        .sort-options select {
            flex: 1; /* Allow each select element to grow to take up available space */
            margin-right: 20px; /* Add some right margin between select elements */
        }

        .sort-options select:last-child {
            margin-right: 0; /* Remove right margin for the last select element */
        }




   /* Button Animation */
   .animated-button {
        display: inline-block;
        padding: 9px 15px;
        color: #fff;
        font-size: 15px;
        background-color: #ff523b;
        border: 10px;
        border-radius: 20px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
     
    }

    .animated-button:hover {
        animation: pulse 1s infinite;
    }

   
    @keyframes pulse {
        0% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.05);
        }
        100% {
            transform: scale(1);
        }
    }

    .search-input {
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ff523b;
        border-radius: 5px;
        transition: border-color 0.3s ease-in-out;
        width: 150px; 
        position: relative;
        top: 0;
        right: -400px;
        padding: 10px;
    }


    #searchBtn{
        position: relative;
        padding: 10px;
        color: #fff;
        font-size: 16px;
        background-color: #ff523b;
        border: 10px;
        border-radius: 20px;
        cursor: pointer;
        right: -100px;
        
        transition: border-color 0.3s ease-in-out;

    }
    .product-container {
    display: block;
}
/* Add styles for search results */
#searchResults {
    margin-top: 20px;
}

#searchResults div {
    padding: 5px;
    border-bottom: 1px solid #ddd;
}

#clearFilterForm{
    padding: 110px;
        font-size: 16px;
     
        border-radius: 5px;
        transition: border-color 0.3s ease-in-out;
        width: 150px; 
        position: relative;
        
        right: 350px;
        padding: 10px;

}




</style>
    </head>
    <body>
        <div class ="header">
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <a href="/Homepage"><img src="images/logo.png" width="125px"></a>
                </div>
               <nav>
                    <ul id="MenuItems">
                        <li><a href="/Homepage">Home</a></li>
                         <li><a href="">Products</a></li>
                         <li><a href="">About</a></li>
                         <li><a href="">Contact</a></li>
                         <li><a href="/userProfile">Account</a></li>
                         <li>
                            <a href="/logout" id="logout-button" class="logout-link">Logout</a>
                        </li>


                    </ul>
                </nav>

                    <!-- /WIishlist  -->
                    <a class="heart-button" href="/wishList">
                        <i class="fa fa-heart"></i>
                    </a>
                    <!-- /WIishlist close -->   


                <a href="/cart"><img src="images/cart.png" width="30px" height="30px"></a>
                <img src="images/menu.png" class="menu-icon" onClick="menutoggle()" >
            </div>
           
        </div>
    </div>
    
    <h2 class="title">All Products</h2>
        
        <!------------------------------ Products------------------------------>
        <div class="small-container" id="product-container">
            <div class="sort-options">
                <form action="/filter" method="post">
                    <select name="category" id="category" class="form-select">
                        <option value="All Categories">All Categories</option>
                        <% categories.forEach(category => { %>
                            <option value="<%= category._id %>"><%= category.category %></option>
                        <% }); %>
                    </select>
                    <select name="sortprice" id="sortprice" class="form-select">
                        <option value="">All Prices</option>
                        <option value="lowToHigh">Low to High</option>
                        <option value="highToLow">High to Low</option>
                    </select>
                    <select name="priceRange" id="priceRange" class="form-select">
                        <option value="">Price Range</option>
                        <option value="100-1000">100 - 1000</option>
                        <option value="1000-1500">1000 - 1500</option>
                        <option value="1500-2000">1500 - 2000</option>
                    </select>
                    <select name="sortAlphabetically" id="sortAlphabetically" class="form-select">
                        <option value="">Alphabetical Order</option>
                        <option value="ascending">Ascending (A to Z)</option>
                        <option value="descending">Descending (Z to A)</option>
                    </select>
                    <button type="submit" class="animated-button">Filter</button>
                </form>
                <input type="text" id="searchInput" class="search-input" placeholder="Search here...">
                <button id="searchBtn">Search</button>
                <form action="/allProducts" method="get" id="clearFilterForm">
                    <button type="submit" class="animated-button">Clear Filter</button>
                </form>
            </div>
    
            
        <!-- <div id="showSearchedProducts" style="height: 70vh; width: 600px;"> -->

        </div>
            <div class="small-container" id="product-container">
                <div class="row" id="product-list">
                    <% if (productcollection && productcollection.length > 0) { %>
                        <% productcollection.forEach(product => { %>
                            <div class="col-4 product-container" id="product-item">
                                <div class="row">
                                    <div class="col-6">
                                        <div class="wishlist-container">
                                            <a href="/wishlist/<%= product._id %>"><i class="fa fa-heart wishlist-icon"></i></a>
                                        </div>
                                        <a href="/getproduct/<%= product._id %>"><img src="<%= product.image[0] %>"></a>
                                    </div>
                                    <div class="col-6">
                                        <a href="/getproduct/<%= product._id %>"><h4><%= product.productname %></h4></a>
                                        <div class="rating">
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star-half-o"></i>
                                            <i class="fa fa-star-o"></i>
                                        </div>
                                        <p>₹<%= product.price %></p>
                                        <a href="/getproduct/<%= product._id %>" class="btn">View</a>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                    <% } else { %>
                        <div class="col-12">
                            <h3 style="color: red;">No products found.</h3>
                        </div>
                    <% } %>
                </div>
            </div>
        
            <div class="pagination" id="pagination">
                <% if (currentPage > 1) { %>
                    <a href="/allProducts?page=<%= currentPage - 1 %>&sortprice=<%= sortprice %>&sortAlphabetically=<%= sortAlphabetically %>&category=<%= category %>&priceRange=<%= priceRange %>">&laquo; Previous</a>
                <% } %>
                <% for (let i = 1; i <= totalPages; i++) { %>
                    <a href="/allProducts?page=<%= i %>&sortprice=<%= sortprice %>&sortAlphabetically=<%= sortAlphabetically %>&category=<%= category %>&priceRange=<%= priceRange %>" class="<%= i === currentPage ? 'active' : '' %>"><%= i %></a>
                <% } %>
                <% if (currentPage < totalPages) { %>
                    <a href="/allProducts?page=<%= currentPage + 1 %>&sortprice=<%= sortprice %>&sortAlphabetically=<%= sortAlphabetically %>&category=<%= category %>&priceRange=<%= priceRange %>">Next &raquo;</a>
                <% } %>
            </div>
        </div>
        
        
        <!----------------------------------footer------------------------------------->
        <div class ="footer">
        <div class="container">
            
            <div class="row">
                <div class="footer-col-1">
                    <h3>Download Our App</h3>
                    <p>Download App for Android and ios mobile phone.</p>
                    <div class="app-logo">
                        <img src="images/play-store.png" alt="">
                        <img src="images/app-store.png" alt="">
                    </div>
                </div>
                <div class="footer-col-2">
                    <img src="images/logo-white.png">
                    <p>Our Purpose Is To Sustainably Make the Pleasure and Benefits of Sports Accessible to the Many.</p>
                </div>
                <div class="footer-col-3">
                    <h3>Useful Links</h3>
                   <ul>
                       <li>Coupons</li>
                       <li>Blog Post</li>
                       <li>Return Policy</li>
                       <li>Join Affiliate</li>
                    </ul>
                </div>
                <div class="footer-col-4">
                    <h3>Follow us</h3>
                   <ul>
                       <li>Facebook</li>
                       <li>Twitter</li>
                       <li>Instagram</li>
                       <li>Youtube</li>
                    </ul>
                </div>
                
            </div>
            
            <hr><!--horizontal line-->
            <p class="copyright">Copyright 2021 - Apurba Kr. Pramanik</p>
            
        </div>
    </div>
  
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <script>
        var menuItems = document.getElementById("MenuItems");
        MenuItems.style.maxHeight = "0px";
        function menutoggle() {
            if (MenuItems.style.maxHeight == "0px") {
                MenuItems.style.maxHeight = "200px";
            } else {
                MenuItems.style.maxHeight = "0px";
            }
        }

        document.getElementById('searchBtn').addEventListener("click", () => searchProducts());

        async function searchProducts(page = 1) {
            console.log("inside click")
            var input = document.getElementById('searchInput').value.toLowerCase();
            if (input.length < 1) {
                alert("Search properly");
                return;
            };

            const response = await fetch('/searchedProducts', {
                method: 'POST',
                headers: {
                    'content-type': "application/json"
                },
                body: JSON.stringify({
                    searchedInput: input,
                    page: page
                })
            });
            const res = await response.json();
            console.log("searchedProducts", res);

            const productContainer = document.getElementById('product-list');
            productContainer.innerHTML = '';

            if (res.products && res.products.length > 0) {
                res.products.forEach(product => {
                    const productHTML = `
                        <div class="col-4 product-container" id="product-item">
                            <div class="row">
                                <div class="col-6">
                                    <div class="wishlist-container">
                                        <a href="/wishlist/${product._id}"><i class="fa fa-heart wishlist-icon"></i></a>
                                    </div>
                                    <a href="/getproduct/${product._id}"><img src="${product.image[0]}" alt="${product.productname}"></a>
                                </div>
                                <div class="col-6">
                                    <a href="/getproduct/${product._id}"><h4>${product.productname}</h4></a>
                                    <div class="rating">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-half-o"></i>
                                        <i class="fa fa-star-o"></i>
                                    </div>
                                    <p>₹${product.price}</p>
                                    <a href="/getproduct/${product._id}" class="btn">View</a>
                                </div>
                            </div>
                        </div>
                    `;
                    productContainer.insertAdjacentHTML('beforeend', productHTML);
                });
            } else {
                productContainer.innerHTML = '<div class="col-12"><h3 style="color: red;">No products found.</h3></div>';
            }

            updatePagination(res.totalPages, res.currentPage);
        }

        function updatePagination(totalPages, currentPage) {
            const paginationContainer = document.getElementById('pagination');
            paginationContainer.innerHTML = '';

            if (currentPage > 1) {
                paginationContainer.innerHTML += `<a href="#" onclick="searchProducts(${currentPage - 1})">&laquo; Previous</a>`;
            }

            for (let i = 1; i <= totalPages; i++) {
                paginationContainer.innerHTML += `<a href="#" onclick="searchProducts(${i})" class="${i === currentPage ? 'active' : ''}">${i}</a>`;
            }

            if (currentPage < totalPages) {
                paginationContainer.innerHTML += `<a href="#" onclick="searchProducts(${currentPage + 1})">Next &raquo;</a>`;
            }
        }

        document.addEventListener("DOMContentLoaded", function () {
            const logoutButton = document.getElementById("logout-button");
            logoutButton.addEventListener("click", function (e) {
                e.preventDefault();
                Swal.fire({
                    title: "Logout",
                    text: "Are you sure you want to logout?",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonText: "Yes, logout",
                    cancelButtonText: "No, cancel"
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = "/logout";
                    }
                });
            });
        });
    </script>
    </body>
</html>
